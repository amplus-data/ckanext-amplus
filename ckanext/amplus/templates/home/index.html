{% resource 'c3charts/main' %}

{% ckan_extends %}

{% block primary_content %}
{{ super() }}

<div class="insights">
    {% set blogs = h.get_recent_blog_posts(4) %} {% if blogs %}
    <p class="group-heading">{{_("Insights")}}</p>
    <div class="container-fluid">
      <div class="row panel-row">
        {% for item in blogs %}
        <div class="col-md-3 col-sm-4 col-xs-12 panel">
          {% if item.image %}
          <a class="item" href="{{ h.url_for(controller='ckanext.pages.controller:PagesController', action='blog_show', page='/' + item.name) }}">
            <div class="image-wrap">
              <img class="image" src="{{ item.image }}" alt="photo"> {% endif %}
            </div>
            <div class="body">
              <p class="title" role="heading">{{ item.title }}</p>
              <p class="description" role="text">{{ item.content|striptags|truncate(300) }}</p>
            </div>
          </a>
        </div>
        {% endfor %}
      </div>
      <a class="view-link" href="{{ h.url_for(action='blog_index', controller='ckanext.pages.controller:PagesController') }}">
          <button class="view-all" type="button">{{_("View All")}}</button>
        </a>
    </div>
    {% endif %}
 </div>

{% endblock %}
